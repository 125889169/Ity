(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-818d86ec"],{"277f":function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return f}));var i=n("b775");function o(t){return Object(i["a"])({url:"/notifications",method:"post",data:t})}function a(t){return Object(i["a"])({url:"/notification",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/notification/allRead",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/notification/unReadCount",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/notification/send",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/notification/read",method:"post",data:t})}function f(t){return Object(i["a"])({url:"/notification/admins",method:"post",data:t})}},"2f21":function(t,e,n){"use strict";var i=n("79e5");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"55dd":function(t,e,n){"use strict";var i=n("5ca1"),o=n("d8e8"),a=n("4bf8"),r=n("79e5"),s=[].sort,l=[1,2,3];i(i.P+i.F*(r((function(){l.sort(void 0)}))||!r((function(){l.sort(null)}))||!n("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(a(this)):s.call(a(this),o(t))}})},"87cd":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form",{ref:"formInline",attrs:{inline:!0,model:t.formInline}},[n("el-form-item",{attrs:{label:t.$t("notification.message"),prop:"message"}},[n("el-input",{attrs:{placeholder:t.$t("notification.message")},model:{value:t.formInline.message,callback:function(e){t.$set(t.formInline,"message",e)},expression:"formInline.message"}})],1),t._v(" "),n("el-form-item",{attrs:{label:t.$t("notification.is_read")}},[n("el-select",{attrs:{placeholder:t.$t("notification.is_read")},model:{value:t.formInline.is_read,callback:function(e){t.$set(t.formInline,"is_read",e)},expression:"formInline.is_read"}},[n("el-option",{attrs:{label:t.$t("exception.solveStatus.all"),value:""}}),t._v(" "),n("el-option",{attrs:{label:t.$t("notification.is_read0"),value:0}}),t._v(" "),n("el-option",{attrs:{label:t.$t("notification.is_read1"),value:1}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:t.$t("common.createTime"),prop:"time"}},[n("el-date-picker",{attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"~","start-placeholder":t.$t("common.startTime"),"end-placeholder":t.$t("common.endTime"),align:"right"},model:{value:t.formInline.time,callback:function(e){t.$set(t.formInline,"time",e)},expression:"formInline.time"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(t._s(t.$t("common.search")))]),t._v(" "),n("el-button",{on:{click:function(e){return t.resetForm("formInline")}}},[t._v(t._s(t.$t("common.reset")))])],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:24}},[n("el-form",{attrs:{inline:!0}},[n("el-form-item",[n("router-link",{attrs:{to:"/notification/send"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-s-promotion"}},[t._v("\n              "+t._s(t.$t("notification.send"))+"\n            ")])],1)],1),t._v(" "),n("el-form-item",[n("el-dropdown",[n("el-button",{attrs:{type:"primary"}},[t._v("\n              "+t._s(t.$t("notification.is_read1"))+" "),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[n("span",{on:{click:t.readHandle}},[t._v(t._s(t.$t("notification.read")))])]),t._v(" "),n("el-dropdown-item",[n("span",{on:{click:t.allReadHandle}},[t._v(t._s(t.$t("notification.allRead")))])])],1)],1)],1)],1)],1),t._v(" "),n("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{span:24}},[n("el-col",{attrs:{span:24}},[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.tableData,"default-sort":{prop:this.sort,order:this.order}},on:{"sort-change":t.tableSortChange,"cell-dblclick":t.notificationInfo}},[n("el-table-column",{attrs:{type:"selection",selectable:t.checkSelect,width:"55"}}),t._v(" "),n("el-table-column",{attrs:{width:"25px"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon-message",style:{color:null===t.row.read_at?"#E6A23C":"#C0C4CC"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("notification.message")},scopedSlots:t._u([{key:"default",fn:function(e){return[null===e.row.read_at?n("span",[n("strong",[t._v(t._s(e.row.data))])]):n("span",[t._v(t._s(e.row.data))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:t.$t("common.createdAt"),formatter:t.rTime,sortable:""}})],1)],1),t._v(" "),n("el-col",{staticClass:"margin-t-10",attrs:{span:24}},[n("el-pagination",{attrs:{"page-sizes":[10,25,50],"page-size":10,"current-page":t.offset,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),t._v(" "),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:t.$t("common.details"),visible:t.notificationInfoShow},on:{"update:visible":function(e){t.notificationInfoShow=e}}},[n("el-form",{attrs:{"label-position":"top"}},[n("el-form-item",{attrs:{label:t.$t("notification.form")}},[t._v("\n        "+t._s(t.notificationInfoData.data?t.notificationInfoData.data.form:"")+"\n      ")]),t._v(" "),n("el-form-item",{attrs:{label:t.$t("notification.message")}},[n("span",{domProps:{innerHTML:t._s(t.notificationInfoData.data?t.notificationInfoData.data.message:"")}})]),t._v(" "),n("el-form-item",{attrs:{label:t.$t("common.createdAt")}},[t._v("\n        "+t._s(t.rTime2(t.notificationInfoData.created_at))+"\n      ")])],1)],1)],1)},o=[],a=(n("ac6a"),n("55dd"),n("4360")),r=n("277f"),s=n("ed08"),l={name:"Notification",data:function(){return{total:0,loading:!0,order:"descending",sort:"created_at",offset:0,limit:10,tableData:[],formInline:{message:"",is_read:"",time:""},pickerOptions:{shortcuts:[{text:this.$t("common.week"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6048e5),t.$emit("pick",[n,e])}},{text:this.$t("common.oneMonth"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-2592e6),t.$emit("pick",[n,e])}},{text:this.$t("common.threeMonth"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-7776e6),t.$emit("pick",[n,e])}}]},notificationInfoShow:!1,notificationInfoData:{}}},mounted:function(){this.getNotifications()},methods:{getNotifications:function(){var t=this;this.loading=!0;var e={offset:this.offset,limit:this.limit,order:this.order,sort:this.sort,message:this.formInline.message};""!==Object(s["d"])(this.formInline.time[0])&&(e["start_at"]=Object(s["d"])(this.formInline.time[0])),""!==Object(s["d"])(this.formInline.time[1])&&(e["end_at"]=Object(s["d"])(this.formInline.time[1])),""!==this.formInline.is_read&&(e["is_read"]=this.formInline.is_read),Object(r["d"])(e).then((function(e){var n=e.data;t.loading=!1,t.tableData=n.notifications,t.total=n.total}))},tableSortChange:function(t){this.order=t.order?t.order:"descending",this.sort=t.prop,this.offset=0,this.getNotifications()},rTime:function(t,e){return Object(s["d"])(t[e.property])},rTime2:function(t){return Object(s["d"])(t)},handleSizeChange:function(t){this.limit=t,this.getNotifications()},handleCurrentChange:function(t){this.offset=t,this.getNotifications()},onSubmit:function(){this.offset=0,this.getNotifications()},resetForm:function(t){this.$refs[t].resetFields(),this.offset=0,this.getNotifications()},notificationInfo:function(t,e){var n=this;Object(r["c"])({id:t.id}).then((function(t){n.notificationInfoShow=!0,n.notificationInfoData=t.data,Object(r["g"])().then((function(t){var e=t.data.count;n.notificationCount(e)})),n.getNotifications()}))},checkSelect:function(t,e){var n=!0;return n=null===t.read_at,n},allReadHandle:function(){var t=this;Object(r["b"])().then((function(e){t.getNotifications(),t.notificationCount(0)}))},readHandle:function(){var t=this,e=[],n=this.$refs.multipleTable.store.states.selection;n.forEach((function(t){e.push(t.id)})),e.length>0?Object(r["e"])({id:e}).then((function(e){t.getNotifications(),Object(r["g"])().then((function(e){var n=e.data.count;t.notificationCount(n)}))})):this.$message.error(this.$t("notification.checkMessage"))},notificationCount:function(t){a["a"].dispatch("user/notificationCount",t)}}},c=l,f=n("2877"),d=Object(f["a"])(c,i,o,!1,null,"bc9d8978",null);e["default"]=d.exports}}]);